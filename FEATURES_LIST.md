# 活動簽到與管理系統 - 功能列表
# Event Check-in & Management System - Features List

## 📋 目錄 (Table of Contents)

1. [事件管理 (Event Management)](#事件管理-event-management)
2. [用戶管理 (User Management)](#用戶管理-user-management)
3. [註冊表單系統 (Registration Form System)](#註冊表單系統-registration-form-system)
4. [簽到系統 (Check-in System)](#簽到系統-check-in-system)
5. [抽獎系統 (Lucky Draw System)](#抽獎系統-lucky-draw-system)
6. [積分系統 (Points System)](#積分系統-points-system)
7. [獎品管理 (Prize Management)](#獎品管理-prize-management)
8. [投票系統 (Voting System)](#投票系統-voting-system)
9. [Treasure Hunt 系統](#treasure-hunt-系統)
10. [電子郵件系統 (Email System)](#電子郵件系統-email-system)
11. [SMS 系統 (SMS System)](#sms-系統-sms-system)
12. [支付系統 (Payment System)](#支付系統-payment-system)
13. [報表與匯出 (Reports & Export)](#報表與匯出-reports--export)
14. [Banner 管理 (Banner Management)](#banner-管理-banner-management)
15. [遊戲系統 (Game System)](#遊戲系統-game-system)
16. [附件管理 (Attachment Management)](#附件管理-attachment-management)
17. [其他功能 (Other Features)](#其他功能-other-features)

---

## 事件管理 (Event Management)

### 基本功能
- ✅ **創建事件** - 創建新的事件，設置事件名稱、時間、所有者
- ✅ **事件列表** - 查看所有事件，支持搜索和篩選
- ✅ **事件詳情** - 查看事件詳細信息
- ✅ **更新事件** - 更新事件信息
- ✅ **刪除事件** - 刪除事件（需確認）

### 事件設置
- ✅ **抽獎設置** - 配置抽獎相關設置
- ✅ **背景圖片上傳** - 上傳抽獎頁面背景圖片
- ✅ **支付事件設置** - 配置付費活動、票券管理
- ✅ **電郵發送設置** - 配置歡迎郵件、確認郵件、提醒郵件、感謝郵件的發送方式
- ✅ **附件管理** - 上傳和管理事件相關附件（PDF、圖片等）

---

## 用戶管理 (User Management)

### 用戶操作
- ✅ **添加用戶** - 手動添加用戶到事件（支持動態表單字段）
- ✅ **批量導入用戶** - 通過 Excel 文件批量導入用戶
- ✅ **下載範本文件** - 下載導入範本 Excel 文件
- ✅ **查看用戶列表** - 查看事件的所有用戶（DataTables 支持）
- ✅ **查看用戶詳情** - 查看單個用戶的詳細信息
- ✅ **內聯編輯** - 雙擊表格單元格直接編輯用戶信息
- ✅ **更新用戶信息** - 更新用戶資料（支持所有動態字段）
- ✅ **刪除用戶** - 從事件中移除用戶
- ✅ **批量刪除用戶** - 批量刪除多個選中的用戶
- ✅ **批量簽到** - 一鍵將所有用戶標記為已簽到

### 用戶功能
- ✅ **用戶登入** - 用戶通過事件專屬登入頁面登入
- ✅ **QR Code 登入** - 通過掃描 QR Code 快速登入
- ✅ **用戶資料頁面** - 用戶查看和編輯自己的資料
- ✅ **重新發送郵件** - 為用戶重新發送多種類型的郵件（Invitation, Welcome, Knowledge, Reminder）
- ✅ **QR Code 生成** - 為每個用戶生成專屬 QR Code
- ✅ **QR Code 下載** - 下載用戶 QR Code 圖片

### 用戶統計
- ✅ **簽到統計** - 顯示已簽到用戶數、總用戶數、簽到率
- ✅ **實時更新** - 簽到狀態實時更新

---

## 註冊表單系統 (Registration Form System)

### 表單配置
- ✅ **動態表單配置** - 通過後台 CMS 完全控制註冊表單字段
- ✅ **字段類型支持** - 支持以下字段類型：
  - 文字 (text)
  - 電子郵件 (email)
  - 電話 (tel)
  - 下拉選單 (select)
  - 多行文字 (textarea)
  - **複選框 (checkbox)** - 可選擇多個選項
  - **單選框 (radio)** - 只能選擇一個選項
- ✅ **多語言支持** - 字段標籤、佔位符、選項支持中英文
- ✅ **字段屬性配置** - 可設置標籤、佔位符、必填狀態、可見性
- ✅ **選項管理** - 為 select、checkbox、radio 類型字段配置選項
- ✅ **區塊管理** - 創建多個表單區塊並分別控制
- ✅ **字段排序** - 通過 order 字段控制字段和區塊的顯示順序
- ✅ **實時預覽** - 配置時可以即時預覽表單效果
- ✅ **配置導出/導入** - 支持 JSON 格式的配置導出和導入
- ✅ **重置功能** - 一鍵重置為預設配置

### 表單功能
- ✅ **多語言切換** - 用戶可在表單頁面切換中英文
- ✅ **URL 參數語言** - 支持通過 `?lang=zh` 或 `?lang=en` URL 參數設置語言
- ✅ **動態字段驗證** - 根據配置自動應用必填驗證
- ✅ **Checkbox 驗證** - 必填 checkbox 至少選擇一個選項
- ✅ **Radio 驗證** - 必填 radio 必須選擇一個選項
- ✅ **表單提交** - 動態收集所有字段數據（包括 checkbox 數組）

---

## 簽到系統 (Check-in System)

### 簽到功能
- ✅ **QR Code 掃描簽到** - 通過掃描 QR Code 進行快速簽到
- ✅ **手動簽到** - 在掃描頁面手動標記用戶為已簽到
- ✅ **簽到狀態顯示** - 實時顯示用戶的簽到狀態（顏色區分）
- ✅ **簽到時間記錄** - 自動記錄用戶簽到的時間
- ✅ **批量簽到** - 一鍵將所有用戶標記為已簽到

### 掃描頁面
- ✅ **掃描器頁面** - 獨立的掃描頁面（無 sidebar，專為簽到設計）
- ✅ **用戶列表顯示** - 顯示所有用戶及其簽到狀態
- ✅ **用戶詳情顯示** - 顯示選中用戶的詳細信息
- ✅ **用戶積分顯示** - 在表格中顯示用戶積分
- ✅ **列印功能** - 列印用戶資料標籤（支持 Printer Bridge）

---

## 抽獎系統 (Lucky Draw System)

### 抽獎顯示頁面
- ✅ **抽獎顯示頁面** - 大螢幕顯示抽獎結果
- ✅ **背景圖片顯示** - 顯示自定義背景圖片
- ✅ **控制器狀態顯示** - 顯示控制器連接狀態
- ✅ **獎品選擇顯示** - 顯示當前選擇的獎品
- ✅ **中獎者顯示** - 顯示所有中獎者信息（姓名、公司、桌號）
- ✅ **動畫效果** - 抽獎時的動畫效果
- ✅ **Socket.IO 實時更新** - 實時同步抽獎結果

### 抽獎控制面板
- ✅ **iPad 控制面板** - 專為 iPad 設計的控制面板
- ✅ **選擇獎品** - 從獎品列表中選擇要抽的獎品
- ✅ **單次抽獎** - 抽取 1 位中獎者
- ✅ **連續抽獎** - 按指定次數連續抽取
- ✅ **手動指定中獎者** - 手動選擇參與者設為中獎者
- ✅ **取消中獎者** - 取消最後一位中獎者或指定中獎者
- ✅ **獎品數量管理** - 自動更新獎品剩餘數量
- ✅ **獎品還原** - 取消中獎者時自動還原獎品數量
- ✅ **中獎編號管理** - 追蹤最大中獎編號，確保唯一性

### 中獎者管理
- ✅ **中獎者列表** - 查看所有中獎者
- ✅ **中獎者詳情** - 查看中獎者詳細信息（包含獎品信息）
- ✅ **匯出中獎者列表** - 將中獎者列表匯出為 Excel
- ✅ **刪除中獎者** - 刪除指定的中獎者記錄

---

## 積分系統 (Points System)

### 積分管理
- ✅ **創建積分類型** - 創建新的積分類型
- ✅ **積分類型列表** - 查看所有積分類型
- ✅ **編輯積分類型** - 編輯積分類型信息
- ✅ **刪除積分類型** - 刪除積分類型
- ✅ **生成 QR Code** - 為積分類型生成 QR Code

### 積分操作
- ✅ **掃描 QR Code 添加積分** - 通過掃描 QR Code 為用戶添加積分
- ✅ **積分掃描器頁面** - 獨立的積分掃描器頁面（無 sidebar）
- ✅ **手動添加積分** - 手動為用戶添加積分
- ✅ **查看用戶積分** - 查看用戶的當前積分
- ✅ **積分歷史記錄** - 查看用戶的積分獲得記錄

### 積分功能
- ✅ **排行榜** - 查看積分排行榜
- ✅ **用戶積分顯示** - 在各種頁面顯示用戶積分

---

## 獎品管理 (Prize Management)

### 獎品操作
- ✅ **創建獎品** - 創建新的獎品
- ✅ **獎品列表** - 查看所有獎品
- ✅ **編輯獎品** - 編輯獎品信息
- ✅ **刪除獎品** - 刪除獎品
- ✅ **上傳獎品圖片** - 上傳獎品圖片
- ✅ **獎品庫存管理** - 管理獎品數量（自動扣減和還原）

---

## 投票系統 (Voting System)

### 投票管理
- ✅ **投票管理頁面** - 後台管理投票選項
- ✅ **添加投票選項** - 添加新的投票選項（支持圖片）
- ✅ **刪除投票選項** - 刪除投票選項
- ✅ **更新投票設置** - 更新投票相關設置

### 投票功能
- ✅ **投票頁面** - 用戶投票頁面
- ✅ **提交投票** - 用戶提交投票
- ✅ **查看投票結果** - 查看投票統計結果
- ✅ **檢查用戶投票狀態** - 檢查用戶是否已投票

---

## Treasure Hunt 系統

### Treasure Hunt 功能
- ✅ **創建 Treasure Hunt 項目** - 創建尋寶項目
- ✅ **項目管理** - 管理 Treasure Hunt 項目列表
- ✅ **QR Code 生成** - 為每個項目生成專屬 QR Code
- ✅ **掃描功能** - 用戶掃描 QR Code 完成項目
- ✅ **積分獎勵** - 完成項目後自動添加積分
- ✅ **掃描記錄** - 記錄用戶已掃描的項目

---

## 電子郵件系統 (Email System)

### 郵件模板管理
- ✅ **模板列表** - 查看所有電子郵件模板
- ✅ **創建模板** - 創建新的電子郵件模板
- ✅ **模板詳情** - 查看模板詳細信息和發送記錄
- ✅ **編輯模板** - 編輯電子郵件模板（支持 TinyMCE 編輯器）
- ✅ **刪除模板** - 刪除電子郵件模板
- ✅ **模板類型** - 支持以下模板類型：
  - **Invitation** (邀請郵件)
  - **Welcome** (歡迎郵件)
  - **Knowledge** (知識郵件)
  - **Reminder** (提醒郵件)

### 模板功能
- ✅ **上傳圖片** - 在模板編輯器中上傳圖片
- ✅ **動態變量替換** - 支持用戶、事件、QR Code 等變量替換
- ✅ **發送郵件** - 使用模板發送郵件給指定收件人
- ✅ **發送記錄** - 查看郵件發送歷史記錄
- ✅ **郵件追蹤** - 追蹤郵件打開狀態
- ✅ **範本模板** - 提供範本模板供參考

### 郵件發送設置
- ✅ **歡迎消息方式** - 設置歡迎消息發送方式（Email / SMS / Both）
- ✅ **自動發送設置** - 配置是否自動發送歡迎、確認、提醒、感謝郵件
- ✅ **重新發送功能** - 在用戶列表中重新發送各類郵件

---

## SMS 系統 (SMS System)

### SMS 模板管理
- ✅ **模板列表** - 查看所有 SMS 模板
- ✅ **創建模板** - 創建新的 SMS 模板
- ✅ **編輯模板** - 編輯 SMS 模板
- ✅ **刪除模板** - 刪除 SMS 模板
- ✅ **模板類型** - 支持多種 SMS 類型

### SMS 功能
- ✅ **發送 SMS** - 使用模板發送 SMS
- ✅ **動態變量替換** - 支持用戶和事件變量替換
- ✅ **多服務商支持** - 支持 Twilio、Plivo 等 SMS 服務商

---

## 支付系統 (Payment System)

### Stripe 整合
- ✅ **Stripe Checkout** - 創建 Stripe 支付會話
- ✅ **Stripe Webhook** - 處理 Stripe 支付回調
- ✅ **支付成功處理** - 處理支付成功事件（自動添加用戶）
- ✅ **支付失敗處理** - 處理支付失敗事件
- ✅ **Session 過期處理** - 處理支付會話過期
- ✅ **Metadata 支持** - 在 Stripe metadata 中保存所有用戶數據

### 交易記錄
- ✅ **交易記錄頁面** - 查看所有交易記錄
- ✅ **交易狀態追蹤** - 追蹤交易狀態（pending, paid, failed）
- ✅ **交易詳情** - 查看交易詳細信息
- ✅ **用戶關聯** - 交易與用戶自動關聯

### 票券管理
- ✅ **創建票券** - 為付費活動創建票券
- ✅ **票券設置** - 設置票券名稱、價格、日期時間
- ✅ **票券選擇** - 用戶在註冊時選擇票券
- ✅ **票券驗證** - 驗證票券有效性（日期檢查）

---

## 報表與匯出 (Reports & Export)

### 報表功能
- ✅ **用戶報表** - 匯出事件用戶列表為 Excel
- ✅ **中獎者報表** - 匯出中獎者列表為 Excel
- ✅ **報表欄位** - 包含用戶基本信息、簽到狀態、簽到時間等
- ✅ **動態字段支持** - 報表包含所有表單配置的動態字段

---

## Banner 管理 (Banner Management)

### Banner 功能
- ✅ **Banner 管理頁面** - 管理事件 Banner
- ✅ **上傳 Banner** - 上傳新的 Banner 圖片
- ✅ **刪除 Banner** - 刪除 Banner 圖片
- ✅ **Banner 顯示** - 在相關頁面顯示 Banner

---

## 遊戲系統 (Game System)

### 遊戲功能
- ✅ **開始遊戲** - 啟動遊戲
- ✅ **結束遊戲** - 結束遊戲
- ✅ **遊戲 API** - 提供遊戲相關 API
- ✅ **遊戲記錄** - 記錄用戶遊戲歷史
- ✅ **積分整合** - 遊戲與積分系統整合

---

## 附件管理 (Attachment Management)

### 附件功能
- ✅ **上傳附件** - 上傳事件相關附件（PDF、圖片等）
- ✅ **附件列表** - 查看所有附件
- ✅ **附件詳情** - 查看附件信息（文件名、大小、類型、上傳時間）
- ✅ **刪除附件** - 刪除附件
- ✅ **附件下載** - 下載附件文件

---

## 其他功能 (Other Features)

### 系統功能
- ✅ **Socket.IO 實時通信** - 用於抽獎系統的實時更新
- ✅ **QR Code 生成** - 生成各種 QR Code（用戶、積分、登入等）
- ✅ **文件上傳** - 支持圖片和 Excel 文件上傳
- ✅ **Excel 匯入/匯出** - Excel 文件的匯入和匯出功能
- ✅ **響應式設計** - 支持桌面和移動設備
- ✅ **多語言支持** - 支持繁體中文和英文界面
- ✅ **URL 參數語言** - 通過 URL 參數（?lang=zh/en）設置語言
- ✅ **Printer Bridge** - Python 打印橋接服務，支持標籤打印

### 用戶體驗
- ✅ **獨立掃描頁面** - 積分掃描器和簽到掃描器獨立頁面
- ✅ **iPad 優化** - 抽獎控制面板專為 iPad 優化
- ✅ **實時狀態顯示** - 顯示控制器連接狀態和獎品選擇狀態
- ✅ **動畫效果** - 抽獎時的視覺動畫效果
- ✅ **Toast 通知** - 操作成功/失敗的提示通知
- ✅ **內聯編輯** - 表格內直接編輯數據
- ✅ **批量操作** - 支持批量刪除、批量簽到等操作

### 數據驗證與安全
- ✅ **必填字段驗證** - 自動驗證必填字段
- ✅ **Email 格式驗證** - 自動驗證電子郵件格式
- ✅ **Checkbox 組驗證** - 必填 checkbox 至少選擇一個
- ✅ **Radio 組驗證** - 必填 radio 必須選擇一個
- ✅ **數據遷移** - 自動遷移舊格式數據到新格式
- ✅ **向後兼容** - 支持舊版本數據格式

---

## 技術特性 (Technical Features)

### 後端技術
- **Node.js + Express.js** - 伺服器框架
- **MongoDB + Mongoose** - 數據庫
- **Socket.IO** - 實時通信
- **Stripe SDK** - 支付處理
- **ExcelJS** - Excel 處理
- **Multer** - 文件上傳
- **QRCode** - QR Code 生成
- **bcrypt** - 密碼加密

### 前端技術
- **EJS** - 模板引擎
- **Bootstrap 4** - UI 框架
- **jQuery** - JavaScript 庫
- **DataTables** - 表格功能
- **HTML5 QR Code Scanner** - QR Code 掃描
- **Socket.IO Client** - 實時通信客戶端
- **TinyMCE** - 富文本編輯器

### 第三方服務
- **Stripe** - 支付處理
- **AWS SES** - 郵件發送
- **SendGrid** - 郵件發送
- **Twilio** - SMS 發送
- **Plivo** - SMS 發送
- **QR Code API** - QR Code 生成

---

## 數據模型 (Data Models)

### 主要模型
- **Event** - 事件模型（包含 users、winners、points 等）
- **User** - 用戶模型（嵌入在 Event 中，支持動態字段）
- **Prize** - 獎品模型
- **Transaction** - 交易記錄模型
- **EmailTemplate** - 電子郵件模板模型
- **SmsTemplate** - SMS 模板模型
- **FormConfig** - 表單配置模型
- **Point** - 積分類型模型（嵌入在 Event 中）
- **Vote** - 投票模型
- **EmailRecord** - 郵件記錄模型
- **GameHistory** - 遊戲歷史記錄模型
- **AwardUser** - 獲獎用戶模型

---

## 功能統計 (Feature Statistics)

### 功能模組統計

| 功能模組 | 功能數量 | 主要功能 |
|---------|---------|---------|
| 事件管理 | 9 | 創建、列表、詳情、設置、附件 |
| 用戶管理 | 18 | CRUD、導入、登入、郵件、QR Code、批量操作 |
| 註冊表單系統 | 15 | 動態配置、7種字段類型、多語言、排序 |
| 簽到系統 | 9 | 掃描、手動、狀態、列印 |
| 抽獎系統 | 18 | 顯示、控制、管理、匯出、實時同步 |
| 積分系統 | 10 | 管理、掃描、排行榜 |
| 獎品管理 | 6 | CRUD、圖片、庫存 |
| 投票系統 | 7 | 管理、投票、統計 |
| Treasure Hunt | 6 | 項目管理、掃描、積分 |
| 電子郵件系統 | 12 | 模板、發送、追蹤、4種類型 |
| SMS 系統 | 6 | 模板、發送、多服務商 |
| 支付系統 | 10 | Stripe、Webhook、交易、票券 |
| 報表匯出 | 4 | 用戶報表、中獎者報表、動態字段 |
| Banner 管理 | 4 | 上傳、刪除、顯示 |
| 遊戲系統 | 5 | 開始、結束、API、記錄 |
| 附件管理 | 5 | 上傳、列表、下載、刪除 |

**總計**: 144+ 個功能點

---

## 最新更新 (Recent Updates)

### 2024 最新功能
- ✅ **Checkbox 字段支持** - 註冊表單支持複選框字段
- ✅ **Radio 字段支持** - 註冊表單支持單選框字段
- ✅ **多語言完整支持** - 表單字段、選項、標籤完整多語言支持
- ✅ **URL 參數語言** - 支持通過 URL 參數設置語言
- ✅ **Email 模板類型擴展** - 新增 Invitation、Knowledge 類型
- ✅ **字段排序功能** - 支持通過 order 字段控制顯示順序
- ✅ **表單配置導出/導入** - JSON 格式配置導出和導入
- ✅ **必填字段自動處理** - 自動處理缺失的必填字段（如 name）

---

*最後更新：2024年12月*
