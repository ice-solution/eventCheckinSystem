<%- include("components/header") %>
<%- include("components/menu", { eventId: eventId }) %>
<link rel="stylesheet" href="/admin/assets/css/cs-skin-elastic.css">
<link rel="stylesheet" href="/admin/assets/css/lib/datatable/dataTables.bootstrap.min.css">
<link rel="stylesheet" href="/admin/assets/css/style.css">

<div id="right-panel" class="right-panel">
    <%- include("components/rightpanel_header") %>
    <div class="content">
        <div class="animated fadeIn">
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <strong class="card-title">Lucky Draw Settings</strong>
                        </div>
                        <div class="card-body">
                            <form id="uploadForm" enctype="multipart/form-data" action="/events/<%= eventId %>/luckydraw_setting/upload-background" method="POST">
                                <div class="form-group">
                                    <label for="backgroundImage">Upload background image (.jpg only):</label>
                                    <input type="file" id="backgroundImage" name="backgroundImage" accept=".jpg, .jpeg" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Upload</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Preview area -->
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <strong class="card-title">Background Image Preview</strong>
                        </div>
                        <div class="card-body text-center">
                            <img id="backgroundPreview" src="/luckydraw/img/<%= eventId %>.jpg" alt="Background preview" style="max-width: 100%; height: auto;">
                            <div id="noImageMessage" style="display: none;">No background image yet</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include("components/footer") %>
<script src="/admin/assets/js/lib/data-table/datatables.min.js"></script>
<script src="/admin/assets/js/lib/data-table/dataTables.bootstrap.min.js"></script>
<script src="/admin/assets/js/lib/data-table/dataTables.buttons.min.js"></script>
<script src="/admin/assets/js/lib/data-table/buttons.bootstrap.min.js"></script>
<script src="/admin/assets/js/lib/data-table/jszip.min.js"></script>
<script src="/admin/assets/js/lib/data-table/vfs_fonts.js"></script>
<script src="/admin/assets/js/lib/data-table/buttons.html5.min.js"></script>
<script src="/admin/assets/js/lib/data-table/buttons.print.min.js"></script>
<script src="/admin/assets/js/lib/data-table/buttons.colVis.min.js"></script>
<script src="/admin/assets/js/init/datatables-init.js"></script>

<script>
    window.onload = function() {
        // Check if image exists
        const img = document.getElementById('backgroundPreview');
        const noImageMessage = document.getElementById('noImageMessage');

        img.onload = function() {
            noImageMessage.style.display = 'none';
        };

        img.onerror = function() {
            img.style.display = 'none';
            noImageMessage.style.display = 'block';
        };
    };
</script>
